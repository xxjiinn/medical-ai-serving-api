<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medical AI Risk Profiling System | JLK Demo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'jlk-purple': '#5B21B6',
                        'jlk-blue': '#3B82F6',
                        'jlk-cyan': '#06B6D4',
                        'jlk-navy': '#0F172A',
                        'jlk-coral': '#F97316',
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');

        * {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0F172A 0%, #1E293B 50%, #0F172A 100%);
            min-height: 100vh;
        }

        .gradient-text {
            background: linear-gradient(135deg, #06B6D4 0%, #3B82F6 50%, #5B21B6 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .card-glow {
            box-shadow: 0 0 40px rgba(59, 130, 246, 0.15);
            transition: all 0.3s ease;
        }

        .card-glow:hover {
            box-shadow: 0 0 60px rgba(59, 130, 246, 0.25);
            transform: translateY(-2px);
        }

        .stat-card {
            background: linear-gradient(135deg, rgba(91, 33, 182, 0.1) 0%, rgba(59, 130, 246, 0.1) 100%);
            border: 1px solid rgba(59, 130, 246, 0.2);
        }

        .btn-primary {
            background: linear-gradient(135deg, #5B21B6 0%, #3B82F6 100%);
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(91, 33, 182, 0.4);
        }

        .loading-spinner {
            border: 3px solid rgba(59, 130, 246, 0.3);
            border-top-color: #3B82F6;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .pulse-dot {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        input, select {
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(59, 130, 246, 0.3);
            color: white;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #3B82F6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
    </style>
</head>
<body class="text-white">
    <!-- Header -->
    <header class="border-b border-gray-800">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="text-2xl font-bold gradient-text">Medical AI Risk Profiling</div>
                    <span class="px-3 py-1 text-xs font-semibold bg-jlk-purple/20 text-jlk-cyan rounded-full border border-jlk-cyan/30">
                        LIVE DEMO
                    </span>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="flex items-center space-x-2">
                        <div class="w-2 h-2 bg-green-500 rounded-full pulse-dot"></div>
                        <span class="text-sm text-gray-400">API Status: <span class="text-green-400 font-semibold" id="apiStatus">Checking...</span></span>
                    </div>
                    <a href="https://github.com/xxjiinn/medical-ai-serving-api" target="_blank"
                       class="text-gray-400 hover:text-jlk-cyan transition">
                        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                        </svg>
                    </a>
                </div>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="container mx-auto px-6 py-16">
        <div class="text-center max-w-4xl mx-auto">
            <h1 class="text-5xl md:text-6xl font-bold mb-6">
                <span class="gradient-text">뇌졸중 치료의 새로운 패러다임으로</span><br>
                <span class="text-white">사람의 생명을 지킵니다</span>
            </h1>
            <p class="text-xl text-gray-400 mb-8 leading-relaxed">
                국민건강보험공단 건강검진 데이터 기반 심혈관 질환 위험도 분석 시스템<br>
                <span class="text-jlk-cyan font-semibold">1,000,000+ 건강검진 레코드</span>로 학습된 ATP III 임상 가이드라인 구현
            </p>
            <div class="flex justify-center space-x-4">
                <button onclick="scrollToSection('demo')" class="btn-primary px-8 py-3 rounded-lg font-semibold">
                    Live Demo 체험하기
                </button>
                <a href="https://github.com/xxjiinn/medical-ai-serving-api" target="_blank"
                   class="px-8 py-3 rounded-lg font-semibold bg-gray-800 hover:bg-gray-700 transition border border-gray-700">
                    GitHub 보기
                </a>
            </div>
        </div>
    </section>

    <!-- Stats Dashboard -->
    <section class="container mx-auto px-6 py-12">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
            <div class="stat-card card-glow rounded-xl p-6">
                <div class="text-gray-400 text-sm font-semibold mb-2">Total Records</div>
                <div class="text-4xl font-bold gradient-text" id="totalRecords">-</div>
                <div class="text-xs text-gray-500 mt-2">국민건강보험 데이터</div>
            </div>
            <div class="stat-card card-glow rounded-xl p-6">
                <div class="text-gray-400 text-sm font-semibold mb-2">Valid Records</div>
                <div class="text-4xl font-bold text-green-400" id="validRecords">-</div>
                <div class="text-xs text-gray-500 mt-2">생물학적 범위 검증 완료</div>
            </div>
            <div class="stat-card card-glow rounded-xl p-6">
                <div class="text-gray-400 text-sm font-semibold mb-2">Cache Performance</div>
                <div class="text-4xl font-bold text-jlk-cyan">99.8%</div>
                <div class="text-xs text-gray-500 mt-2">Redis 캐싱 개선율</div>
            </div>
            <div class="stat-card card-glow rounded-xl p-6">
                <div class="text-gray-400 text-sm font-semibold mb-2">Response Time</div>
                <div class="text-4xl font-bold text-jlk-coral">4ms</div>
                <div class="text-xs text-gray-500 mt-2">평균 API 응답 시간</div>
            </div>
        </div>
    </section>

    <!-- Demo Section -->
    <section id="demo" class="container mx-auto px-6 py-12">
        <div class="text-center mb-12">
            <h2 class="text-4xl font-bold gradient-text mb-4">Interactive API Demo</h2>
            <p class="text-gray-400">실시간으로 API를 테스트하고 결과를 확인하세요</p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Risk Distribution -->
            <div class="bg-gray-900/50 card-glow rounded-xl p-8 border border-gray-800">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-2xl font-bold text-white">위험군 분포 통계</h3>
                    <button onclick="fetchRiskStats()" class="btn-primary px-6 py-2 rounded-lg text-sm font-semibold">
                        통계 조회
                    </button>
                </div>
                <div class="bg-jlk-navy/50 rounded-lg p-6 mb-6">
                    <canvas id="riskChart" height="280"></canvas>
                </div>
                <div id="riskResponse" class="bg-black/30 rounded-lg p-4 overflow-x-auto hidden">
                    <pre class="text-xs text-gray-400"><code id="riskJson"></code></pre>
                </div>
            </div>

            <!-- Age Distribution -->
            <div class="bg-gray-900/50 card-glow rounded-xl p-8 border border-gray-800">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-2xl font-bold text-white">연령대별 분포</h3>
                    <button onclick="fetchAgeStats()" class="btn-primary px-6 py-2 rounded-lg text-sm font-semibold">
                        통계 조회
                    </button>
                </div>
                <div class="bg-jlk-navy/50 rounded-lg p-6 mb-6">
                    <canvas id="ageChart" height="280"></canvas>
                </div>
                <div id="ageResponse" class="bg-black/30 rounded-lg p-4 overflow-x-auto hidden">
                    <pre class="text-xs text-gray-400"><code id="ageJson"></code></pre>
                </div>
            </div>

            <!-- Records Table -->
            <div class="bg-gray-900/50 card-glow rounded-xl p-8 border border-gray-800 lg:col-span-2">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-2xl font-bold text-white">건강검진 레코드 조회</h3>
                    <div class="flex items-center space-x-4">
                        <select id="recordLimit" class="px-4 py-2 rounded-lg">
                            <option value="5">5 records</option>
                            <option value="10" selected>10 records</option>
                            <option value="20">20 records</option>
                        </select>
                        <button onclick="fetchRecords()" class="btn-primary px-6 py-2 rounded-lg text-sm font-semibold">
                            조회
                        </button>
                    </div>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full" id="recordsTable">
                        <thead class="bg-jlk-purple/20 border-b border-jlk-purple/30">
                            <tr>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-300">ID</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-300">Age Group</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-300">Gender</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-300">BMI</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-300">Risk Factors</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-300">Risk Group</th>
                            </tr>
                        </thead>
                        <tbody id="recordsBody" class="divide-y divide-gray-800">
                            <tr>
                                <td colspan="6" class="px-4 py-8 text-center text-gray-500">
                                    조회 버튼을 클릭하세요
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Risk Simulation -->
            <div class="bg-gray-900/50 card-glow rounded-xl p-8 border border-gray-800 lg:col-span-2">
                <h3 class="text-2xl font-bold text-white mb-6">심혈관 질환 위험도 시뮬레이션</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="md:col-span-2">
                        <div class="grid grid-cols-2 gap-4 mb-6">
                            <div>
                                <label class="block text-sm font-semibold text-gray-400 mb-2">Age Group</label>
                                <select id="simAge" class="w-full px-4 py-2 rounded-lg">
                                    <option value="6">30-34세</option>
                                    <option value="8">40-44세</option>
                                    <option value="10" selected>50-54세</option>
                                    <option value="12">60-64세</option>
                                    <option value="14">70-74세</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-400 mb-2">Gender</label>
                                <select id="simGender" class="w-full px-4 py-2 rounded-lg">
                                    <option value="1" selected>Male</option>
                                    <option value="2">Female</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-400 mb-2">Height (cm)</label>
                                <input type="number" id="simHeight" value="175" class="w-full px-4 py-2 rounded-lg">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-400 mb-2">Weight (kg)</label>
                                <input type="number" id="simWeight" value="80" class="w-full px-4 py-2 rounded-lg">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-400 mb-2">Systolic BP</label>
                                <input type="number" id="simSBP" value="145" class="w-full px-4 py-2 rounded-lg">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-400 mb-2">Diastolic BP</label>
                                <input type="number" id="simDBP" value="95" class="w-full px-4 py-2 rounded-lg">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-400 mb-2">Fasting Glucose</label>
                                <input type="number" id="simGlucose" value="130" class="w-full px-4 py-2 rounded-lg">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-400 mb-2">Total Cholesterol</label>
                                <input type="number" id="simTC" value="250" class="w-full px-4 py-2 rounded-lg">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-400 mb-2">Triglycerides</label>
                                <input type="number" id="simTG" value="200" class="w-full px-4 py-2 rounded-lg">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-400 mb-2">HDL Cholesterol</label>
                                <input type="number" id="simHDL" value="35" class="w-full px-4 py-2 rounded-lg">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-400 mb-2">Smoking Status</label>
                                <select id="simSmoking" class="w-full px-4 py-2 rounded-lg">
                                    <option value="never">Never</option>
                                    <option value="former">Former</option>
                                    <option value="current" selected>Current</option>
                                </select>
                            </div>
                            <div class="flex items-end">
                                <button onclick="simulateRisk()" class="btn-primary w-full px-6 py-2 rounded-lg font-semibold">
                                    위험도 계산
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="bg-jlk-navy/50 rounded-lg p-6">
                        <h4 class="text-lg font-bold text-white mb-4">Risk Assessment</h4>
                        <div id="simResult" class="space-y-3">
                            <div class="text-gray-500 text-sm text-center py-8">
                                위험도 계산 버튼을 클릭하세요
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="container mx-auto px-6 py-12 mt-20 border-t border-gray-800">
        <div class="text-center">
            <div class="text-2xl font-bold gradient-text mb-4">Medical AI Risk Profiling System</div>
            <p class="text-gray-400 mb-4">Built with Flask • Redis • MySQL • Railway</p>
            <div class="flex justify-center space-x-6 text-sm text-gray-500">
                <a href="https://github.com/xxjiinn/medical-ai-serving-api" class="hover:text-jlk-cyan transition">GitHub</a>
                <span>•</span>
                <a href="https://medical-ai-serving-api-production.up.railway.app/health" class="hover:text-jlk-cyan transition">API Health</a>
                <span>•</span>
                <span>ATP III Clinical Guidelines</span>
            </div>
        </div>
    </footer>

    <script>
        const API_BASE = 'https://medical-ai-serving-api-production.up.railway.app';
        const API_KEY = '0WCeJCbW18-rlmiuKsyAboiPfFIMZUzOTqYgFQdUrRc';

        let riskChart = null;
        let ageChart = null;

        // Check API Health
        async function checkAPIHealth() {
            try {
                const response = await fetch(`${API_BASE}/health`);
                const data = await response.json();
                document.getElementById('apiStatus').textContent = data.status === 'ok' ? 'Online' : 'Offline';
            } catch (error) {
                document.getElementById('apiStatus').textContent = 'Offline';
                document.getElementById('apiStatus').classList.remove('text-green-400');
                document.getElementById('apiStatus').classList.add('text-red-400');
            }
        }

        // Fetch Risk Statistics
        async function fetchRiskStats() {
            showLoading('riskChart');
            try {
                const response = await fetch(`${API_BASE}/stats/risk`, {
                    headers: { 'X-API-Key': API_KEY }
                });
                const data = await response.json();

                document.getElementById('totalRecords').textContent = data.total_records.toLocaleString();
                document.getElementById('validRecords').textContent = data.valid_records.toLocaleString();

                document.getElementById('riskJson').textContent = JSON.stringify(data, null, 2);
                document.getElementById('riskResponse').classList.remove('hidden');

                displayRiskChart(data.risk_distribution);
            } catch (error) {
                console.error('Error:', error);
                alert('Failed to fetch risk statistics');
            }
        }

        // Display Risk Chart
        function displayRiskChart(distribution) {
            const ctx = document.getElementById('riskChart');

            if (riskChart) riskChart.destroy();

            riskChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: [
                        'Low Risk (0-1 factors)',
                        'Multiple Risk Factors',
                        'CHD Risk Equivalent'
                    ],
                    datasets: [{
                        data: [
                            distribution.ZERO_TO_ONE_RISK_FACTOR.percentage,
                            distribution.MULTIPLE_RISK_FACTORS.percentage,
                            distribution.CHD_RISK_EQUIVALENT.percentage
                        ],
                        backgroundColor: [
                            'rgba(34, 197, 94, 0.8)',
                            'rgba(251, 191, 36, 0.8)',
                            'rgba(239, 68, 68, 0.8)'
                        ],
                        borderColor: [
                            'rgba(34, 197, 94, 1)',
                            'rgba(251, 191, 36, 1)',
                            'rgba(239, 68, 68, 1)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: '#9CA3AF',
                                font: { size: 12 },
                                padding: 15
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + context.parsed + '%';
                                }
                            }
                        }
                    }
                }
            });
        }

        // Fetch Age Statistics
        async function fetchAgeStats() {
            showLoading('ageChart');
            try {
                const response = await fetch(`${API_BASE}/stats/age`, {
                    headers: { 'X-API-Key': API_KEY }
                });
                const data = await response.json();

                document.getElementById('ageJson').textContent = JSON.stringify(data, null, 2);
                document.getElementById('ageResponse').classList.remove('hidden');

                displayAgeChart(data.age_distribution);
            } catch (error) {
                console.error('Error:', error);
                alert('Failed to fetch age statistics');
            }
        }

        // Display Age Chart
        function displayAgeChart(distribution) {
            const ctx = document.getElementById('ageChart');

            if (ageChart) ageChart.destroy();

            const labels = [];
            const counts = [];

            Object.entries(distribution).forEach(([key, value]) => {
                labels.push(value.age_range);
                counts.push(value.count);
            });

            ageChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Records',
                        data: counts,
                        backgroundColor: 'rgba(59, 130, 246, 0.8)',
                        borderColor: 'rgba(59, 130, 246, 1)',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return 'Count: ' + context.parsed.y.toLocaleString();
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { color: '#9CA3AF' },
                            grid: { color: 'rgba(75, 85, 99, 0.2)' }
                        },
                        x: {
                            ticks: { color: '#9CA3AF' },
                            grid: { display: false }
                        }
                    }
                }
            });
        }

        // Fetch Records
        async function fetchRecords() {
            const limit = document.getElementById('recordLimit').value;
            const tbody = document.getElementById('recordsBody');
            tbody.innerHTML = '<tr><td colspan="6" class="px-4 py-8 text-center"><div class="loading-spinner w-8 h-8 rounded-full mx-auto"></div></td></tr>';

            try {
                const response = await fetch(`${API_BASE}/records?limit=${limit}`, {
                    headers: { 'X-API-Key': API_KEY }
                });
                const data = await response.json();

                tbody.innerHTML = '';
                data.data.forEach(record => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-gray-800/50 transition';
                    row.innerHTML = `
                        <td class="px-4 py-3 text-sm">${record.id}</td>
                        <td class="px-4 py-3 text-sm">${record.age_group}</td>
                        <td class="px-4 py-3 text-sm">${record.gender === 1 ? 'Male' : 'Female'}</td>
                        <td class="px-4 py-3 text-sm">${record.bmi}</td>
                        <td class="px-4 py-3 text-sm">
                            <span class="px-2 py-1 bg-jlk-purple/20 text-jlk-cyan rounded text-xs">
                                ${record.risk_factor_count}
                            </span>
                        </td>
                        <td class="px-4 py-3 text-sm">
                            <span class="px-2 py-1 rounded text-xs ${getRiskGroupColor(record.risk_group)}">
                                ${formatRiskGroup(record.risk_group)}
                            </span>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
            } catch (error) {
                tbody.innerHTML = '<tr><td colspan="6" class="px-4 py-8 text-center text-red-400">Failed to load records</td></tr>';
            }
        }

        // Simulate Risk
        async function simulateRisk() {
            const result = document.getElementById('simResult');
            result.innerHTML = '<div class="text-center py-8"><div class="loading-spinner w-8 h-8 rounded-full mx-auto"></div></div>';

            const data = {
                age_group: parseInt(document.getElementById('simAge').value),
                gender: parseInt(document.getElementById('simGender').value),
                height: parseInt(document.getElementById('simHeight').value),
                weight: parseInt(document.getElementById('simWeight').value),
                systolic_bp: parseInt(document.getElementById('simSBP').value),
                diastolic_bp: parseInt(document.getElementById('simDBP').value),
                fasting_glucose: parseInt(document.getElementById('simGlucose').value),
                total_cholesterol: parseInt(document.getElementById('simTC').value),
                triglycerides: parseInt(document.getElementById('simTG').value),
                hdl_cholesterol: parseInt(document.getElementById('simHDL').value),
                smoking_status: document.getElementById('simSmoking').value
            };

            try {
                const response = await fetch(`${API_BASE}/simulate`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-API-Key': API_KEY
                    },
                    body: JSON.stringify(data)
                });
                const res = await response.json();

                if (res.error) {
                    result.innerHTML = `<div class="text-red-400 text-sm">${res.message}</div>`;
                    return;
                }

                const flags = res.result.flags;
                const riskFactors = [];
                if (flags.hypertension) riskFactors.push('Hypertension');
                if (flags.diabetes) riskFactors.push('Diabetes');
                if (flags.high_total_cholesterol) riskFactors.push('High TC');
                if (flags.high_triglycerides) riskFactors.push('High TG');
                if (flags.low_hdl) riskFactors.push('Low HDL');
                if (flags.obesity_asia) riskFactors.push('Obesity');
                if (flags.smoking) riskFactors.push('Smoking');

                result.innerHTML = `
                    <div class="text-center mb-4">
                        <div class="text-3xl font-bold ${getRiskGroupTextColor(res.result.risk_group)} mb-2">
                            ${formatRiskGroup(res.result.risk_group)}
                        </div>
                        <div class="text-sm text-gray-400">BMI: ${res.input.bmi}</div>
                    </div>
                    <div class="space-y-2">
                        <div class="text-xs font-semibold text-gray-400 mb-2">Risk Factors (${res.result.risk_factor_count}/7)</div>
                        ${riskFactors.map(f => `
                            <div class="flex items-center space-x-2 text-sm">
                                <div class="w-2 h-2 bg-red-500 rounded-full"></div>
                                <span>${f}</span>
                            </div>
                        `).join('')}
                        ${riskFactors.length === 0 ? '<div class="text-sm text-gray-500">No risk factors detected</div>' : ''}
                    </div>
                `;
            } catch (error) {
                result.innerHTML = '<div class="text-red-400 text-sm">Simulation failed</div>';
            }
        }

        // Helper functions
        function getRiskGroupColor(group) {
            if (group === 'ZERO_TO_ONE_RISK_FACTOR') return 'bg-green-500/20 text-green-400';
            if (group === 'MULTIPLE_RISK_FACTORS') return 'bg-yellow-500/20 text-yellow-400';
            return 'bg-red-500/20 text-red-400';
        }

        function getRiskGroupTextColor(group) {
            if (group === 'ZERO_TO_ONE_RISK_FACTOR') return 'text-green-400';
            if (group === 'MULTIPLE_RISK_FACTORS') return 'text-yellow-400';
            return 'text-red-400';
        }

        function formatRiskGroup(group) {
            if (group === 'ZERO_TO_ONE_RISK_FACTOR') return 'Low Risk';
            if (group === 'MULTIPLE_RISK_FACTORS') return 'Multiple Risk';
            return 'High Risk';
        }

        function showLoading(chartId) {
            const canvas = document.getElementById(chartId);
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        function scrollToSection(id) {
            document.getElementById(id).scrollIntoView({ behavior: 'smooth' });
        }

        // Initialize
        checkAPIHealth();
        setInterval(checkAPIHealth, 30000);
    </script>
</body>
</html>
